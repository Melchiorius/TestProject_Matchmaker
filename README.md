# TestProject_Matchmaker


Тестовый проект.
Набросок балансера для подбора игроков в группу.
Принимает пакеты POST с JSON в теле вида:
{
    "name": "Sveta",
    "skill": 30,
    "latency": 250
}

Подбирает игроков на основе того, не увеличит ли их добавление в группу standard deviation для параметров skill и latency сверх заданного в файле параметров (matchmaker.properties) предела.

Общая логика:
При появлении нового игрока, добавляет его во все подходящие группы и дополнительно создает для него его собственную группу.
Группы изначально создаются в порядке появления игроков, поэтому фактически список групп отсортирован по времени ожидания от большего к меньшему.
Как только в какой-то группе число игроков срало равно параметру groupSize, эта группа считается сформированной. Игроки этой группы удаляются из других групп. Пустые группы удаляются. Информация о сформированной группе выводится в консоль. После этого сформированная группа удаляется.

За счет такого порядка действий удается добиться того, чтобы игроки не ждали слишком долго, но при этом уровни их skill и latency были достаточно близки между собой.


Ожидаемая проблема:
Ситуация: Первым заходит игрок, skill или latency которого постоянно находятся на "границе" заданных параметров по сравнению с игроками, которые заходят позже. К нему в группу будут добавляться отдельные игроки, но недостаточно для того, чтобы сформирововать группу. Так как в других группых игроки будут ближе друг другу по skill и latency, их группы будут формировавываться быстрее, а значит, будут "красть" игроков из первой группы. Таким образом первый игрок будет очень долго находится в ожидании.


TODO:
1. Добавить систему смягчения требований по параметрам, если время ожидания игроков в группе слишком большое (пусть лучше играют с кем-то более сильным, чем продолжают скучать в очереди). Потребуется сделать так, чтобы была проверка игроков из других групп, не подходят ли они для данной группы после смягчения требования. Игроков нужно будет отсортировать по тому, насколько они близки к игрокам внутри игруппы, и добавить самых близких.
2. Над классами Group и User хорошо бы добавить аннотации @Component и @Scope("prototype"). А то как-то единообразие нарушается.
3. В коде есть места, где GroupServiceImpl, Group и User перекидываются данными. Нужно подумать, как сделать такие места более читаемыми.


